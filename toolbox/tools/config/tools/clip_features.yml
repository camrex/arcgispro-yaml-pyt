# =============================================================================
# Clip Features Tool Configuration
# =============================================================================
# Purpose:
#   Extracts input features that overlap the clip features boundary.
#   Similar to cookie-cutter or spatial intersection operation.
#
# Author: YAML Toolbox Example
# Created: 2026-01-15
# Last Modified: 2026-01-15
#
# Notes:
#   - Input and clip features must have overlapping spatial extents
#   - Output will be in the spatial reference of the input features
#   - Preserves all attributes from input features
# =============================================================================

# Tool metadata
tool:
  name: clip_features
  label: "Clip Features"
  description: "Clip features to a boundary"
  category: "Analysis"
  canRunInBackground: true

# Python implementation
implementation:
  executeFunction: "toolbox.tools.utils.clip.execute_clip"

# Parameter definitions
parameters:
  - name: input_features
    index: 0
    displayName: "Input Features"
    datatype: GPFeatureLayer
    parameterType: Required
    direction: Input
    description: "Features to clip"
  
  - name: clip_features
    index: 1
    displayName: "Clip Features"
    datatype: GPFeatureLayer
    parameterType: Required
    direction: Input
    description: "Boundary for clipping"
  
  - name: output_features
    index: 2
    displayName: "Output Features"
    datatype: GPFeatureLayer
    parameterType: Required
    direction: Output
    description: "Clipped output features"

# Documentation metadata for ArcGIS Pro
documentation:
  summary: |
    Extracts input features that overlap the clip features boundary. This tool 
    operates like a cookie cutter, cutting out portions of the input features 
    that fall within the clip features extent.
  
  usage: |
    The Clip Features tool extracts features from the input that fall within the 
    area defined by the clip features. The tool preserves all attributes from 
    the input features and outputs features in the spatial reference of the input.
    
    Tips and Best Practices:
    - Input and clip features must have overlapping spatial extents
    - The clip features can be points, lines, or polygons
    - When using polygon clip features, only features within or intersecting the 
      boundary are extracted
    - Attributes from the input features are preserved in the output
    - The output spatial reference matches the input features
    - For optimal performance with large datasets, ensure your data has spatial indexes
    - Consider using the clip boundary that best matches your analysis needs
  
  tags:
    - clip
    - extract
    - analysis
    - overlay
    - geoprocessing
    - spatial analysis
  
  credits: |
    Example tool demonstrating YAML-based configuration for ArcGIS Pro Python Toolbox. 
    Based on standard ArcGIS Clip analysis operations.
  
  use_limitations: |
    This tool is provided for educational and demonstration purposes. Users may 
    apply this tool to their analysis workflows subject to:
    - No warranty for accuracy or fitness for specific applications
    - User responsibility for validating results against authoritative sources
    - Compliance with organizational data usage and licensing policies
    - Not certified for regulatory or legal boundary determinations
  
  parameter_syntax:
    input_features:
      dialog_explanation: |
        The features to be clipped. These can be point, line, or polygon features 
        from a feature class, shapefile, or layer. Only features that intersect 
        or fall within the clip features boundary will be extracted.
      scripting_explanation: |
        A string representing the path to the feature class, shapefile, or layer 
        name. Example: r"C:\Data\roads.shp" or "roads_layer"
    
    clip_features:
      dialog_explanation: |
        The boundary features used to clip the input features. Typically a polygon 
        feature class representing a study area, administrative boundary, or area 
        of interest. Features can be points, lines, or polygons.
      scripting_explanation: |
        A string representing the path to the clip feature class or layer. 
        Example: r"C:\Data\study_area.shp" or "boundary_layer"
    
    output_features:
      dialog_explanation: |
        The output feature class that will contain the clipped features. This 
        will have the same geometry type as the input features and will inherit 
        all attributes. Specify a path to a new feature class.
      scripting_explanation: |
        A string representing the output path. Example: r"C:\Data\output.gdb\clipped_roads"
  
  code_samples:
    - title: "Basic Clip Operation"
      description: |
        Clip roads to a city boundary to extract only roads within the city limits.
      code: |
        import arcpy
        
        # Set input parameters
        roads = r"C:\Data\county_roads.shp"
        city_boundary = r"C:\Data\city_limits.shp"
        output = r"C:\Data\output.gdb\city_roads"
        
        # Run clip operation
        arcpy.yamlanalysistoolbox.ClipFeatures(roads, city_boundary, output)
        
        print(f"Clip complete: {output}")
    
    - title: "Multiple Feature Classes to Same Boundary"
      description: |
        Clip multiple feature classes to a common study area boundary.
      code: |
        import arcpy
        
        study_area = r"C:\Data\study_area.shp"
        input_layers = [
            (r"C:\Data\parcels.shp", "parcels_clipped"),
            (r"C:\Data\roads.shp", "roads_clipped"),
            (r"C:\Data\buildings.shp", "buildings_clipped")
        ]
        
        output_gdb = r"C:\Data\output.gdb"
        
        for input_fc, output_name in input_layers:
            output_fc = f"{output_gdb}\\{output_name}"
            arcpy.yamlanalysistoolbox.ClipFeatures(
                input_fc, study_area, output_fc
            )
            print(f"Clipped {output_name}")
    
    - title: "Clip with Selected Features"
      description: |
        Clip features using a subset of clip features (selected features only).
      code: |
        import arcpy
        
        # Create a layer with selected features
        arcpy.management.MakeFeatureLayer(
            r"C:\Data\watersheds.shp", 
            "watershed_layer",
            "AREA_SQ_MI > 100"  # Select large watersheds only
        )
        
        # Clip streams to the large watersheds
        arcpy.yamlanalysistoolbox.ClipFeatures(
            input_features=r"C:\Data\streams.shp",
            clip_features="watershed_layer",
            output_features=r"C:\Data\output.gdb\clipped_streams"
        )
        
        print("Clipped streams to large watersheds")
